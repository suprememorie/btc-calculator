<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>æ¯”ç‰¹å¹£è¤‡åˆ©è¨ˆç®—æ©Ÿ v1.6</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial; max-width: 750px; margin: auto; padding: 20px; }
    h1 { text-align: center; }
    input, select, button { width: 100%; margin: 8px 0; padding: 10px; }
    #result, #btcPriceBox { margin-top: 20px; background: #f9f9f9; padding: 10px; border-radius: 8px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; font-size: 14px; }
  </style>
</head>
<body>

<h1>ğŸ“ˆ æ¯”ç‰¹å¹£è¤‡åˆ©è¨ˆç®—æ©Ÿ v1.6</h1>

<label>åˆå§‹æœ¬é‡‘ï¼ˆUSDTï¼‰</label>
<input type="number" id="initial" value="150">

<label>æ¯æœˆæŠ•å…¥ï¼ˆUSDTï¼‰</label>
<input type="number" id="monthly" value="150">

<label>æŠ•è³‡æœŸæ•¸ï¼ˆå¹´ï¼‰</label>
<input type="number" id="years" value="7">

<label>åˆ©ç‡ï¼ˆæ•¸å€¼ï¼‰</label>
<input type="number" id="rate" value="1">

<label>åˆ©ç‡å–®ä½</label>
<select id="rateType">
  <option value="daily">æ—¥åˆ©ç‡ï¼ˆ%ï¼‰</option>
  <option value="weekly">é€±åˆ©ç‡ï¼ˆ%ï¼‰</option>
  <option value="monthly">æœˆåˆ©ç‡ï¼ˆ%ï¼‰</option>
  <option value="yearly">å¹´åˆ©ç‡ï¼ˆ%ï¼‰</option>
</select>

<label>è¤‡åˆ©é€±æœŸ</label>
<select id="compoundType">
  <option value="daily">æ—¥è¤‡åˆ©</option>
  <option value="weekly">é€±è¤‡åˆ©</option>
  <option value="monthly" selected>æœˆè¤‡åˆ©</option>
  <option value="yearly">å¹´è¤‡åˆ©</option>
</select>

<label>æ¯”ç‰¹å¹£åƒ¹æ ¼ï¼ˆUSDï¼‰</label>
<input type="number" id="btcPrice" />

<button onclick="calculate()">é–‹å§‹æ¨¡æ“¬</button>

<div id="btcPriceBox">â³ è®€å–æ¯”ç‰¹å¹£å³æ™‚åƒ¹æ ¼ä¸­...</div>
<div id="result"></div>
<canvas id="chart" height="100"></canvas>

<script>
async function getBTCPrice() {
  const res = await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd");
  const data = await res.json();
  const btcPrice = data.bitcoin.usd;
  document.getElementById("btcPrice").value = btcPrice;
  document.getElementById("btcPriceBox").innerText = `ğŸ“Š å³æ™‚æ¯”ç‰¹å¹£åƒ¹æ ¼ï¼š$${btcPrice} USD`;
}

function convertRate(rate, rateType, compoundType) {
  const daily = {
    daily: 1,
    weekly: 1 / 7,
    monthly: 1 / 30,
    yearly: 1 / 365
  };
  return rate / 100 * (daily[rateType] / daily[compoundType]);
}

function calculate() {
  const initial = parseFloat(document.getElementById("initial").value);
  const monthly = parseFloat(document.getElementById("monthly").value);
  const years = parseInt(document.getElementById("years").value);
  const rate = parseFloat(document.getElementById("rate").value);
  const rateType = document.getElementById("rateType").value;
  const compoundType = document.getElementById("compoundType").value;
  const btcPrice = parseFloat(document.getElementById("btcPrice").value);

  const freq = { daily: 365, weekly: 52, monthly: 12, yearly: 1 };
  const periods = years * freq[compoundType];
  const adjRate = convertRate(rate, rateType, compoundType);
  
  let balance = initial;
  const growth = [];
  const tableRows = [];

  for (let i = 1; i <= periods; i++) {
    if (compoundType === 'monthly' && i % 1 === 0) balance += monthly;
    if (compoundType === 'weekly' && i % 4 === 0) balance += monthly;
    if (compoundType === 'daily' && i % 30 === 0) balance += monthly;
    if (compoundType === 'yearly' && i % 1 === 0) balance += monthly * 12;

    balance *= (1 + adjRate);
    growth.push(balance.toFixed(2));

    if (i % (freq[compoundType]) === 0 || i === 1 || i === periods) {
      tableRows.push(`<tr>
        <td>${i}</td>
        <td>${balance.toFixed(2)}</td>
        <td>${(balance / btcPrice).toFixed(6)} BTC</td>
      </tr>`);
    }
  }

  document.getElementById("result").innerHTML = `
    <p>ğŸ“Œ æœ€çµ‚è³‡ç”¢ç¸½å€¼ï¼š<strong>${balance.toFixed(2)} USDT</strong></p>
    <p>â‚¿ æ›ç®—ç‚ºæ¯”ç‰¹å¹£ï¼šç´„ <strong>${(balance / btcPrice).toFixed(6)} BTC</strong></p>
    <table>
      <tr><th>æœŸæ•¸</th><th>è³‡ç”¢ï¼ˆUSDTï¼‰</th><th>é ä¼° BTC</th></tr>
      ${tableRows.join("")}
    </table>
  `;

  const ctx = document.getElementById("chart").getContext("2d");
  if (window.myChart) window.myChart.destroy();
  window.myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: Array.from({length: growth.length}, (_, i) => i + 1),
      datasets: [{
        label: 'è³‡ç”¢æˆé•·æ›²ç·š',
        data: growth,
        borderColor: '#2ecc71',
        fill: false,
        tension: 0.2
      }]
    }
  });
}

getBTCPrice();
</script>

</body>
</html>