<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>æ¯”ç‰¹å¹£è¤‡åˆ©è¨ˆç®—æ©Ÿ v1.8</title>
  <style>
    body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
    label, select, input, button { display: block; margin: 5px 0; width: 100%; max-width: 400px; }
    table { margin-top: 20px; border-collapse: collapse; width: 100%; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: center; font-size: 14px; }
    .summary { margin-top: 30px; padding: 10px; background: #f9f9f9; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h2>ğŸ“ˆ æ¯”ç‰¹å¹£è¤‡åˆ©è¨ˆç®—æ©Ÿ v1.8</h2>

  <label>åˆå§‹æœ¬é‡‘ (USDT):</label>
  <input type="number" id="initialPrincipal" value="150" />

  <label>æ¯æœŸæŠ•å…¥é‡‘é¡ (USDT):</label>
  <input type="number" id="contributionAmount" value="150" />

  <label>æŠ•å…¥é »ç‡ï¼š</label>
  <select id="contributionFrequency">
    <option value="daily">æ¯æ—¥</option>
    <option value="weekly">æ¯é€±</option>
    <option value="monthly" selected>æ¯æœˆ</option>
    <option value="yearly">æ¯å¹´</option>
  </select>

  <label>å¹´é™ (å¹´):</label>
  <input type="number" id="years" value="7" />

  <label>åˆ©ç‡æ•¸å€¼ (%):</label>
  <input type="number" id="rate" value="15" />

  <label>åˆ©ç‡å–®ä½ï¼š</label>
  <select id="rateUnit">
    <option value="daily">æ—¥åˆ©ç‡</option>
    <option value="weekly">é€±åˆ©ç‡</option>
    <option value="monthly" selected>æœˆåˆ©ç‡</option>
    <option value="yearly">å¹´åˆ©ç‡</option>
  </select>

  <label>è¤‡åˆ©é€±æœŸï¼š</label>
  <select id="compoundFrequency">
    <option value="daily">æ—¥è¤‡åˆ©</option>
    <option value="weekly">é€±è¤‡åˆ©</option>
    <option value="monthly" selected>æœˆè¤‡åˆ©</option>
    <option value="yearly">å¹´è¤‡åˆ©</option>
  </select>

  <label>æ¯”ç‰¹å¹£åƒ¹æ ¼ï¼ˆUSDï¼‰ï¼š</label>
  <input type="number" id="btcPrice" value="116633" />

  <button onclick="calculate()">ğŸ“Š é–‹å§‹è¨ˆç®—</button>

  <div class="summary" id="summaryText"></div>

  <table id="resultTable">
    <thead>
      <tr>
        <th>æœŸæ•¸</th>
        <th>æŠ•å…¥ç¸½é¡ (USDT)</th>
        <th>æœŸæœ«è³‡ç”¢ (USDT)</th>
        <th>ç´¯ç©æ¯”ç‰¹å¹£ (BTC)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    const freqPerYear = {
      daily: 365,
      weekly: 52,
      monthly: 12,
      yearly: 1,
    };

    function getRatePerCompound(rate, fromUnit, toUnit) {
      const from = freqPerYear[fromUnit];
      const to = freqPerYear[toUnit];
      const annualRate = Math.pow(1 + rate / 100, from) - 1;
      return Math.pow(1 + annualRate, 1 / to) - 1;
    }

    function calculate() {
      const principal = parseFloat(document.getElementById("initialPrincipal").value);
      const contribution = parseFloat(document.getElementById("contributionAmount").value);
      const years = parseFloat(document.getElementById("years").value);
      const rate = parseFloat(document.getElementById("rate").value);
      const rateUnit = document.getElementById("rateUnit").value;
      const compoundFreq = document.getElementById("compoundFrequency").value;
      const contributionFreq = document.getElementById("contributionFrequency").value;
      const btcPrice = parseFloat(document.getElementById("btcPrice").value);

      const totalPeriods = freqPerYear[compoundFreq] * years;
      const compoundRate = getRatePerCompound(rate, rateUnit, compoundFreq);
      const contributionInterval = freqPerYear[compoundFreq] / freqPerYear[contributionFreq];

      let balance = principal;
      let totalInvested = principal;
      let resultRows = "";

      for (let i = 1; i <= totalPeriods; i++) {
        if (i % contributionInterval === 0) {
          balance += contribution;
          totalInvested += contribution;
        }
        balance *= (1 + compoundRate);
        const btc = balance / btcPrice;

        resultRows += `
          <tr>
            <td>${i}</td>
            <td>${totalInvested.toFixed(2)}</td>
            <td>${balance.toFixed(2)}</td>
            <td>${btc.toFixed(6)}</td>
          </tr>`;
      }

      document.querySelector("#resultTable tbody").innerHTML = resultRows;

      // Summary
      const btcFinal = (balance / btcPrice).toFixed(6);
      const summary = `
        ğŸ“Œ æ¨¡æ“¬æ™‚é–“ï¼š${years} å¹´<br>
        ğŸ“ˆ æœ€çµ‚è³‡ç”¢ï¼š<strong>${balance.toFixed(2)} USDT</strong><br>
        ğŸª™ ç´¯ç©æ¯”ç‰¹å¹£æ•¸é‡ï¼šç´„ <strong>${btcFinal} BTC</strong><br>
        ğŸ’¸ ç¸½æŠ•å…¥é‡‘é¡ï¼š<strong>${totalInvested.toFixed(2)} USDT</strong><br>
        ğŸ“Š ç¸½å ±é…¬å€ç‡ï¼šç´„ <strong>${(balance / totalInvested).toFixed(2)} å€</strong>
      `;
      document.getElementById("summaryText").innerHTML = summary;
    }
  </script>
</body>
</html>